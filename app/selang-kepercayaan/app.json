[{"name":"app.R","content":"# Memanggil paket ----\r\nlibrary(shiny)\r\nlibrary(tidyverse)\r\n\r\n# Mendefinisikan UI ----\r\nui <- fluidPage(\r\n  title = \"Demonstrasi Cakupan Selang Kepercayaan -- Aplikasi Shiny\",\r\n  navbarPage(\r\n    \"Cakupan Selang Kepercayaan\",\r\n    ## Tab proporsi ----\r\n    tabPanel(\r\n      \"Proporsi\",\r\n      sidebarPanel(\r\n        wellPanel(\r\n          ### Memilih proporsi populasi ----\r\n          sliderInput(\"p_prop\", \"Proporsi populasi:\",\r\n            0.5,\r\n            min = 0, max = 1, step = 0.01\r\n          )\r\n        ),\r\n        wellPanel(\r\n          ### Memilih tingkat kepercayaan SK proporsi ----\r\n          sliderInput(\"tingkat_keper_prop\",\r\n            \"Tingkat kepercayaan (%):\",\r\n            min = 80, max = 99,\r\n            value = 95, step = 1\r\n          )\r\n        ),\r\n        wellPanel(\r\n          ### Memilih ukuran sampel proporsi ----\r\n          sliderInput(\"n_prop\", \"Ukuran sampel:\",\r\n            30,\r\n            min = 10, max = 100, step = 5\r\n          ),\r\n          ### Memilih banyak sampel proporsi ----\r\n          sliderInput(\"k_prop\", \"Banyak sampel:\",\r\n            20,\r\n            min = 10, max = 1000, step = 10\r\n          )\r\n        )\r\n      ),\r\n      mainPanel(\r\n        ### Panel utama ----\r\n        plotOutput(\"plot_cakupan_prop\",\r\n          height = \"360px\"\r\n        ),\r\n        fluidRow(\r\n          column(\r\n            8,\r\n            div(p(textOutput(\"teks_cakupan_prop\"),\r\n              align = \"justify\"\r\n            )),\r\n            div(p(textOutput(\"teks_perbandingan_prop\"),\r\n              align = \"justify\"\r\n            ))\r\n          ),\r\n          column(4, plotOutput(\"plot_dist_pop_prop\",\r\n            height = \"200px\"\r\n          ))\r\n        )\r\n      )\r\n    ),\r\n    ## Tab rerata ----\r\n    tabPanel(\r\n      \"Rerata\",\r\n      sidebarLayout(\r\n        sidebarPanel(\r\n          wellPanel(\r\n            ### Memilih distribusi populasi ----\r\n            radioButtons(\"dist_pop_rrt\",\r\n              \"Distribusi populasi:\",\r\n              choices = c(\r\n                \"Normal\" = \"rnorm\",\r\n                \"Seragam\" = \"runif\",\r\n                \"Condong ke kanan\" = \"rlnorm\",\r\n                \"Condong ke kiri\" = \"rbeta\",\r\n                \"Puncak ganda\" = \"rnorm2\"\r\n              ),\r\n              selected = \"rnorm\"\r\n            ),\r\n            ### Memilih kondisi statistik ----\r\n            radioButtons(\"sigma_rrt\",\r\n              \"Sigma diketahui:\",\r\n              choices = c(\"Ya\", \"Tidak\"),\r\n              selected = \"Tidak\",\r\n              inline = TRUE\r\n            )\r\n          ),\r\n          wellPanel(\r\n            ### Memilih tingkat kepercayaan SK rerata ----\r\n            sliderInput(\"tingkat_keper_rrt\",\r\n              \"Tingkat kepercayaan (%):\",\r\n              min = 80, max = 99,\r\n              value = 95, step = 1\r\n            )\r\n          ),\r\n          wellPanel(\r\n            ### Memilih ukuran sampel ----\r\n            sliderInput(\"n_rrt\",\r\n              \"Ukuran sampel:\",\r\n              value = 30,\r\n              min = 2,\r\n              max = 100\r\n            ),\r\n            hr(),\r\n            ### Menentukan banyak sampel ----\r\n            sliderInput(\"k_rrt\",\r\n              \"Banyaknya sampel:\",\r\n              value = 20,\r\n              min = 10,\r\n              max = 1000,\r\n              step = 10\r\n            )\r\n          )\r\n        ),\r\n        mainPanel(\r\n          ### Plot output rerata ----\r\n          plotOutput(\"plot_cakupan_rrt\",\r\n            height = \"360px\"\r\n          ),\r\n          fluidRow(\r\n            column(\r\n              8,\r\n              div(p(textOutput(\"teks_cakupan_rrt\"),\r\n                align = \"justify\"\r\n              )),\r\n              div(p(textOutput(\"teks_perbandingan_rrt\"),\r\n                align = \"justify\"\r\n              ))\r\n            ),\r\n            column(\r\n              4,\r\n              plotOutput(\"plot_dist_pop_rrt\",\r\n                height = \"200px\"\r\n              )\r\n            )\r\n          )\r\n        )\r\n      )\r\n    ),\r\n    ## Tab informasi ----\r\n    tabPanel(\r\n      \"Informasi\",\r\n      sidebarLayout(\r\n        sidebarPanel(\r\n          wellPanel(\r\n            div(h4(\"Deskripsi\",\r\n              style = \"font-size: inherit;\r\n                             font-weight: bold\"\r\n            )),\r\n            div(p(\"Aplikasi Shiny ini digunakan untuk mendemonstrasikan cakupan selang kepercayaan proporsi dan rerata terhadap parameter populasinya.\"))\r\n          ),\r\n          wellPanel(\r\n            div(h4(\"Kode sumber\",\r\n              style = \"font-size: inherit;\r\n                             font-weight: bold\"\r\n            )),\r\n            div(p(\"Kode sumber aplikasi ini tersedia di\", a(\"repositori Github.\", href = \"https://github.com/ydkristanto/apl-selang-kepercayaan\", target = \"_blank\"), \"Jika Anda ingin melaporkan masalah atau meminta fitur tambahan terhadap aplikasi ini, silakan\", a(\"buat sebuah isu\", href = \"https://github.com/ydkristanto/apl-selang-kepercayaan/issues\", target = \"_blank\"), \"atau lebih baik lagi\", a(\"minta penarikan\", href = \"https://github.com/ydkristanto/apl-selang-kepercayaan/pulls\", target = \"_blank\"), \"di repositori tersebut.\"))\r\n          ),\r\n          wellPanel(\r\n            div(h4(\"Lisensi\",\r\n              style = \"font-size: inherit;\r\n                             font-weight: bold\"\r\n            )),\r\n            div(\r\n              p(\"Lisensi MIT\"),\r\n              p(\"Copyright (c) 2024 Yosep Dwi Kristanto\")\r\n            )\r\n          )\r\n        ),\r\n        mainPanel(\r\n          div(h3(\"Aplikasi Shiny Selang Kepercayaan\")),\r\n          div(p(\"Aplikasi interaktif ini dimaksudkan untuk mendemonstrasikan selang-selang kepercayaan proporsi dan rerata yang mencakup parameter populasinya. Beberapa ide penting statistik yang ditunjukkan oleh aplikasi ini antara lain sebagai berikut.\"), align = \"justify\"),\r\n          div(tags$ul(\r\n            tags$li(\"Semakin besar tingkat kepercayaannya, semakin besar persentase selang kepercayaan yang mencakup parameter populasinya.\"),\r\n            tags$li(\"Semakin besar tingkat kepercayaannya, pias galatnya juga semakin besar. Hal ini ditunjukkan dengan semakin panjangnya selang kepercayaannya.\"),\r\n            tags$li(\"Untuk rerata, ketika ukuran sampelnya kecil dan populasinya tidak berdistribusi normal, hubungan antara tingkat kepercayaan dan persentase pencakupan semakin tidak menentu.\")\r\n          ), align = \"justify\"),\r\n          hr(),\r\n          div(p(\"Aplikasi interaktif ini dikembangkan dengan menggunakan bahasa pemrogram\", a(\"R\", href = \"https://www.R-project.org/\", target = \"_blank\"), \"dan paket\", a(\"Shiny.\", href = \"https://CRAN.R-project.org/package=shiny\", target = \"_blank\"), \"Paket\", a(\"shinylive\", href = \"https://posit-dev.github.io/r-shinylive/\", target = \"_blank\"), \"digunakan untuk mengekspor aplikasi ini agar dapat dijalankan di peramban web tanpa peladen R yang terpisah.\"), align = \"justify\"),\r\n          div(p(\"Pengembang dan pemelihara aplikasi ini adalah\", a(\"Yosep Dwi Kristanto,\", href = \"https://people.usd.ac.id/~ydkristanto/\", target = \"_blank\"), \"seorang dosen dan peneliti di program studi\", a(\"Pendidikan Matematika,\", href = \"https://usd.ac.id/s1pmat\", target = \"_blank\"), a(\"Universitas Sanata Dharma,\", href = \"https://www.usd.ac.id/\", target = \"_blank\"), \"Yogyakarta.\"), align = \"justify\"),\r\n          hr(),\r\n          div(h4(\"Penafian tentang penggunaan AI:\",\r\n            style = \"font-size: inherit; font-weight: bold\"\r\n          )),\r\n          div(p(\"Perumusan kode-kode di balik aplikasi Shiny ini dibantu oleh kecerdasan buatan (AI) yang akurasinya selalu diawasi secara cermat oleh pengembang. Meskipun demikian, ide konseptual dan mendasar dari aplikasi ini orisinal dan dihasilkan oleh pengembang. Setiap potensi kesalahan atau keterbatasan dalam kode-kode tersebut menjadi tanggung jawab pengembang, dan bantuan AI diakui sebagai alat pendukung dalam proses pengembangan aplikasi ini.\")),\r\n          br(),\r\n          width = 6\r\n        )\r\n      )\r\n    )\r\n  )\r\n)\r\n\r\n# Fungsi peladen ----\r\nseed <- as.numeric(Sys.time())\r\nserver <- function(input, output) {\r\n  ## Fungsi untuk proporsi ----\r\n  ## Fungsi untuk membuat data dan menentukan selang kepercayaan\r\n  membuat_data <- function(p, n_prop, k_prop, tk_prop) {\r\n    set.seed(seed)\r\n    set_sampel <- matrix(rbinom(n_prop * k_prop, size = 1, prob = p),\r\n      ncol = k_prop\r\n    )\r\n    data_sk <- lapply(1:k_prop, function(i) {\r\n      sampel <- set_sampel[, i]\r\n      tingkat_keper <- as.numeric(tk_prop) / 100\r\n      prop_test <- prop.test(sum(sampel), length(sampel),\r\n        conf.level = tingkat_keper\r\n      )\r\n      sk <- prop_test$conf.int\r\n      rerata <- mean(sampel)\r\n      mencakup_p <- p >= sk[1] && p <= sk[2]\r\n      data.frame(\r\n        x = i, xend = i, y = sk[1], yend = sk[2],\r\n        mencakup_p = mencakup_p, rerata = rerata\r\n      )\r\n    })\r\n    return(data_sk)\r\n  }\r\n  rep_membuat_data <- repeatable(membuat_data)\r\n\r\n  ### Plot cakupan selang kepercayaan ----\r\n  output$plot_cakupan_prop <- renderPlot({\r\n    data_sk <- rep_membuat_data(\r\n      input$p_prop, input$n_prop,\r\n      input$k_prop, input$tingkat_keper_prop\r\n    )\r\n    k <- input$k_prop\r\n    alpha_sk <- function(x) {\r\n      return(1 / 1633500 * (x - 1000)^2 + 4 / 10)\r\n    }\r\n\r\n    ggplot() +\r\n      geom_segment(\r\n        data = do.call(rbind, data_sk),\r\n        aes(\r\n          x = x, xend = xend, y = y, yend = yend,\r\n          color = factor(mencakup_p)\r\n        ),\r\n        linewidth = 1,\r\n        alpha = alpha_sk(k)\r\n      ) +\r\n      geom_point(\r\n        data = do.call(rbind, data_sk),\r\n        aes(\r\n          x = x, y = rerata,\r\n          color = factor(mencakup_p)\r\n        ),\r\n        size = 2\r\n      ) +\r\n      geom_hline(\r\n        yintercept = input$p_prop, linetype = \"dashed\",\r\n        color = \"black\", linewidth = 1\r\n      ) +\r\n      scale_color_manual(\r\n        values = c(\r\n          \"FALSE\" = \"#d95f02\",\r\n          \"TRUE\" = \"#1b9e77\"\r\n        ),\r\n        name = \"Mencakup p?\",\r\n        labels = c(\r\n          \"FALSE\" = \"Tidak\",\r\n          \"TRUE\" = \"Ya\"\r\n        )\r\n      ) +\r\n      labs(\r\n        title = \"Cakupan selang kepercayaan proporsi\",\r\n        y = \"Proporsi\"\r\n      ) +\r\n      theme_bw(base_size = 16) +\r\n      theme(\r\n        axis.title.x = element_blank(),\r\n        axis.text.x = element_blank(),\r\n        axis.ticks.x = element_blank(),\r\n        legend.position = \"bottom\"\r\n      )\r\n  })\r\n\r\n  ### Teks informasi grafik ----\r\n  output$teks_cakupan_prop <- renderText({\r\n    n <- input$n_prop\r\n    k <- input$k_prop\r\n    tingkat_keper <- as.numeric(input$tingkat_keper_prop)\r\n    data_sk <- rep_membuat_data(\r\n      input$p_prop, input$n_prop,\r\n      input$k_prop, input$tingkat_keper_prop\r\n    )\r\n    persen_mencakup <- mean(sapply(\r\n      data_sk,\r\n      function(sk) sk$mencakup_p\r\n    )) * 100\r\n    paste(\"Gambar di atas memvisualisasikan \", k, \" selang kepercayaan \", tingkat_keper, \"% dari tiap-tiap sampel yang terpilih. Persentase selang kepercayaan yang mencakup proporsi populasi: \", round(persen_mencakup, 2), \"%\", sep = \"\")\r\n  })\r\n\r\n  ### Teks perbandingan proporsi ----\r\n  output$teks_perbandingan_prop <- renderText({\r\n    \"Sebagai perbandingan, silakan cermati distribusi populasinya dan amati sebaran proporsi sampel-sampelnya. Dalam distribusi populasi tersebut, proporsi sampel direpresentasikan sebagai garis berwarna hijau dan oranye.\"\r\n  })\r\n\r\n  ### Plot distribusi populasi ----\r\n  output$plot_dist_pop_prop <- renderPlot({\r\n    data_sk <- rep_membuat_data(\r\n      input$p_prop, input$n_prop,\r\n      input$k_prop, input$tingkat_keper_prop\r\n    )\r\n    p <- input$p_prop\r\n    data_pop <- data.frame(\r\n      x = c(\r\n        rep(1, p * 1000),\r\n        rep(0, (1 - p) * 1000)\r\n      )\r\n    )\r\n    ggplot() +\r\n      geom_segment(\r\n        aes(\r\n          x = 0, y = 0,\r\n          xend = 0, yend = 1 - p\r\n        ),\r\n        linewidth = 2\r\n      ) +\r\n      geom_segment(\r\n        aes(\r\n          x = 1, y = 0,\r\n          xend = 1, yend = p\r\n        ),\r\n        linewidth = 2\r\n      ) +\r\n      geom_point(aes(x = c(0, 1), y = c(1 - p, p)),\r\n        size = 2\r\n      ) +\r\n      geom_segment(\r\n        data = do.call(rbind, data_sk),\r\n        aes(\r\n          x = rerata, y = 0,\r\n          xend = rerata, yend = Inf,\r\n          color = factor(mencakup_p)\r\n        ),\r\n        alpha = .5\r\n      ) +\r\n      geom_segment(\r\n        aes(\r\n          x = p, y = 0,\r\n          xend = p, yend = Inf\r\n        ),\r\n        linetype = \"dashed\",\r\n        linewidth = 1\r\n      ) +\r\n      scale_x_continuous(\r\n        breaks = c(0, 1),\r\n        minor_breaks = NULL,\r\n        limits = c(-.25, 1.25)\r\n      ) +\r\n      scale_color_manual(values = c(\r\n        \"TRUE\" = \"#1b9e77\",\r\n        \"FALSE\" = \"#d95f02\"\r\n      )) +\r\n      theme_bw() +\r\n      ylim(0, 1) +\r\n      theme(\r\n        legend.position = \"none\",\r\n        axis.title = element_blank(),\r\n        axis.text.x = element_blank(),\r\n        axis.ticks.x = element_blank()\r\n      ) +\r\n      coord_flip() +\r\n      labs(title = \"Distribusi populasi\")\r\n  })\r\n  ## Fungsi untuk rerata ----\r\n  ### Fungsi hasilkan data ----\r\n  rnorm2 <- function(n, mu1, mu2, sd) {\r\n    return(c(\r\n      rnorm(n = round(2 / 5 * n), mean = mu1, sd = sd),\r\n      rnorm(n = n - round(2 / 5 * n), mean = mu2, sd = sd)\r\n    ))\r\n  }\r\n  hasilkan_data <- function(dist, n, k, tk, sigma) {\r\n    data_sk <- lapply(1:k, function(i) {\r\n      if (dist == \"rnorm\") {\r\n        sampel <- rnorm(n, mean = 500, sd = 100)\r\n        rrt_pop <- 500\r\n        sd_pop <- 100\r\n      } else if (dist == \"rlnorm\") {\r\n        sampel <- rlnorm(n, meanlog = 6, sdlog = .3)\r\n        rrt_pop <- exp(6 + (.3)^2 / 2)\r\n        sd_pop <- sqrt((exp(.3^2) - 1) * exp(2 * 6 + .3^2))\r\n      } else if (dist == \"rbeta\") {\r\n        sampel <- rbeta(n, shape1 = 5, shape2 = 1.5) * 650\r\n        rrt_pop <- 5 / (5 + 1.5) * 650\r\n        sd_pop <- sqrt(5 * 1.5 / ((5 + 1.5)^2 * (5 + 1.5 + 1))) * 650\r\n      } else if (dist == \"runif\") {\r\n        sampel <- runif(n, min = 300, max = 700)\r\n        rrt_pop <- 500\r\n        sd_pop <- sqrt(1 / 12 * (700 - 300)^2)\r\n      } else if (dist == \"rnorm2\") {\r\n        sampel <- rnorm2(n, mu1 = 400, mu2 = 600, sd = 50)\r\n        rrt_pop <- 2 / 5 * 400 + 3 / 5 * 600\r\n        sd_pop <- sqrt(2 / 5 * (50^2 + (400 - 520)^2) +\r\n          3 / 5 * (50^2 + (600 - 520)^2))\r\n      }\r\n      rerata_sampel <- mean(sampel)\r\n      if (sigma == \"Ya\") {\r\n        selang_kepercayaan <- qnorm(\r\n          c(\r\n            0.5 - as.numeric(tk) / 200,\r\n            0.5 + as.numeric(tk) / 200\r\n          ),\r\n          mean = rerata_sampel,\r\n          sd = sd_pop / sqrt(n)\r\n        )\r\n      } else {\r\n        selang_kepercayaan <- t.test(sampel,\r\n          conf.level = as.numeric(tk) / 100\r\n        )$conf.int\r\n      }\r\n\r\n      # Periksa apakah selang kepercayaan mencakup rerata populasi\r\n      mencakup_rrt_populasi <- selang_kepercayaan[1] <= rrt_pop &&\r\n        selang_kepercayaan[2] >= rrt_pop\r\n\r\n      data.frame(\r\n        x = i, xend = i, y = selang_kepercayaan[1],\r\n        yend = selang_kepercayaan[2], rerata = rerata_sampel,\r\n        mencakup_rrt_populasi = mencakup_rrt_populasi\r\n      )\r\n    })\r\n    return(data_sk)\r\n  }\r\n  rep_hasilkan_data <- repeatable(hasilkan_data)\r\n\r\n  ### Plot selang kepercayaan rerata ----\r\n  output$plot_cakupan_rrt <- renderPlot({\r\n    data_sk <- rep_hasilkan_data(\r\n      input$dist_pop_rrt, input$n_rrt, input$k_rrt,\r\n      input$tingkat_keper_rrt,\r\n      input$sigma_rrt\r\n    )\r\n    k <- input$k_rrt\r\n    alpha_sk <- function(x) {\r\n      return(1 / 1633500 * (x - 1000)^2 + 4 / 10)\r\n    }\r\n    if (input$dist_pop_rrt == \"rnorm\") {\r\n      rrt_pop <- 500\r\n    } else if (input$dist_pop_rrt == \"rlnorm\") {\r\n      rrt_pop <- exp(6 + (.3)^2 / 2)\r\n    } else if (input$dist_pop_rrt == \"rbeta\") {\r\n      rrt_pop <- 5 / (5 + 1.5) * 650\r\n    } else if (input$dist_pop_rrt == \"runif\") {\r\n      rrt_pop <- 500\r\n    } else if (input$dist_pop_rrt == \"rnorm2\") {\r\n      rrt_pop <- 520\r\n    }\r\n\r\n    ggplot() +\r\n      geom_segment(\r\n        data = do.call(rbind, data_sk),\r\n        aes(\r\n          x = x, xend = xend, y = y, yend = yend,\r\n          color = factor(mencakup_rrt_populasi)\r\n        ),\r\n        linewidth = 1,\r\n        alpha = alpha_sk(k)\r\n      ) +\r\n      geom_point(\r\n        data = do.call(rbind, data_sk),\r\n        aes(\r\n          x = x, y = rerata,\r\n          color = factor(mencakup_rrt_populasi)\r\n        ),\r\n        size = 2\r\n      ) +\r\n      geom_hline(\r\n        yintercept = rrt_pop, linetype = \"dashed\",\r\n        linewidth = 1\r\n      ) +\r\n      scale_color_manual(\r\n        name = \"Mencakup mu?\",\r\n        values = c(\r\n          \"TRUE\" = \"#1b9e77\",\r\n          \"FALSE\" = \"#d95f02\"\r\n        ),\r\n        labels = c(\r\n          \"TRUE\" = \"Ya\",\r\n          \"FALSE\" = \"Tidak\"\r\n        )\r\n      ) +\r\n      labs(\r\n        title = \"Cakupan selang kepercayaan rerata\",\r\n        x = \"Nomor Sampel\", y = \"Nilai\"\r\n      ) +\r\n      theme_bw(base_size = 16) +\r\n      theme(\r\n        legend.position = \"bottom\",\r\n        axis.title.x = element_blank(),\r\n        axis.text.x = element_blank(),\r\n        axis.ticks.x = element_blank()\r\n      )\r\n  })\r\n  ### Teks informasi grafik ----\r\n  output$teks_cakupan_rrt <- renderText({\r\n    n <- input$n_rrt\r\n    k <- input$k_rrt\r\n    tingkat_keper <- as.numeric(input$tingkat_keper_rrt)\r\n    if (input$dist_pop_rrt == \"rnorm\") {\r\n      dist_pop <- \"normal\"\r\n      rrt_pop <- 500\r\n      sd_pop <- 100\r\n    } else if (input$dist_pop_rrt == \"rlnorm\") {\r\n      dist_pop <- \"condong ke kanan\"\r\n      rrt_pop <- exp(6 + (.3)^2 / 2)\r\n      sd_pop <- sqrt((exp(.3^2) - 1) * exp(2 * 6 + .3^2))\r\n    } else if (input$dist_pop_rrt == \"rbeta\") {\r\n      dist_pop <- \"condong ke kiri\"\r\n      rrt_pop <- 5 / (5 + 1.5) * 650\r\n      sd_pop <- sqrt(5 * 1.5 / ((5 + 1.5)^2 * (5 + 1.5 + 1))) * 650\r\n    } else if (input$dist_pop_rrt == \"runif\") {\r\n      dist_pop <- \"seragam\"\r\n      rrt_pop <- 500\r\n      sd_pop <- sqrt(1 / 12 * (700 - 300)^2)\r\n    } else if (input$dist_pop_rrt == \"rnorm2\") {\r\n      dist_pop <- \"puncak ganda\"\r\n      rrt_pop <- 2 / 5 * 400 + 3 / 5 * 600\r\n      sd_pop <- sqrt(2 / 5 * (50^2 + (400 - 520)^2) +\r\n        3 / 5 * (50^2 + (600 - 520)^2))\r\n    }\r\n    data_sk <- rep_hasilkan_data(\r\n      input$dist_pop_rrt, input$n_rrt,\r\n      input$k_rrt, input$tingkat_keper_rrt,\r\n      input$sigma_rrt\r\n    )\r\n    persen_mencakup <- mean(sapply(\r\n      data_sk,\r\n      function(sk) {\r\n        sk$mencakup_rrt_populasi\r\n      }\r\n    )) * 100\r\n    paste(\"Gambar di atas memvisualisasikan \", k, \" selang kepercayaan \", tingkat_keper, \"% dari tiap-tiap sampel yang terpilih. Setiap sampel tersebut dipilih secara acak dari sebuah populasi yang berdistribusi \", dist_pop, \" dengan rerata, mu = \", round(rrt_pop, 2), \", dan simpangan baku, sigma = \", round(sd_pop, 2), \". Persentase selang kepercayaan yang mencakup rerata populasi: \", round(persen_mencakup, 2), \"%\", sep = \"\")\r\n  })\r\n\r\n  ### Teks perbandingan rerata ----\r\n  output$teks_perbandingan_rrt <- renderText({\r\n    \"Sebagai perbandingan, silakan cermati distribusi populasinya dan amati sebaran rerata sampel-sampelnya. Dalam distribusi populasi tersebut, rerata sampel direpresentasikan sebagai garis berwarna hijau dan oranye.\"\r\n  })\r\n\r\n\r\n  ### Distribusi populasi ----\r\n  output$plot_dist_pop_rrt <- renderPlot({\r\n    data_sk <- rep_hasilkan_data(\r\n      input$dist_pop_rrt, input$n_rrt, input$k_rrt,\r\n      input$tingkat_keper_rrt,\r\n      input$sigma_rrt\r\n    )\r\n    dnorm2 <- function(x) {\r\n      2 / 5 * dnorm(x, mean = 400, sd = 50) + 3 / 5 *\r\n        dnorm(x, mean = 600, sd = 50)\r\n    }\r\n    if (input$dist_pop_rrt == \"rnorm\") {\r\n      fun_pop <- function(x) {\r\n        dnorm(x, mean = 500, sd = 100)\r\n      }\r\n      x_min <- 200\r\n      x_max <- 800\r\n      rrt_pop <- 500\r\n    } else if (input$dist_pop_rrt == \"rlnorm\") {\r\n      fun_pop <- function(x) {\r\n        dlnorm(x, meanlog = 6, sdlog = .3)\r\n      }\r\n      x_min <- 150\r\n      x_max <- 1200\r\n      rrt_pop <- exp(6 + (.3)^2 / 2)\r\n    } else if (input$dist_pop_rrt == \"rbeta\") {\r\n      fun_pop <- function(x) {\r\n        dbeta(x / 650, shape1 = 5, shape2 = 1.5) * 650\r\n      }\r\n      x_min <- 100\r\n      x_max <- 650\r\n      rrt_pop <- 5 / (5 + 1.5) * 650\r\n    } else if (input$dist_pop_rrt == \"runif\") {\r\n      fun_pop <- function(x) {\r\n        dunif(x, min = 300, max = 700)\r\n      }\r\n      x_min <- 153.6\r\n      x_max <- 846.4\r\n      rrt_pop <- 500\r\n    } else if (input$dist_pop_rrt == \"rnorm2\") {\r\n      fun_pop <- function(x) {\r\n        2 / 5 * dnorm(x, mean = 400, sd = 50) + 3 / 5 *\r\n          dnorm(x, mean = 600, sd = 50)\r\n      }\r\n      x_min <- 190\r\n      x_max <- 850\r\n      rrt_pop <- 2 / 5 * 400 + 3 / 5 * 600\r\n    }\r\n    ggplot() +\r\n      stat_function(\r\n        fun = fun_pop,\r\n        geom = \"area\",\r\n        alpha = .2\r\n      ) +\r\n      geom_segment(\r\n        data = do.call(rbind, data_sk),\r\n        aes(\r\n          x = rerata, y = 0,\r\n          xend = rerata, yend = Inf,\r\n          color = factor(mencakup_rrt_populasi)\r\n        ),\r\n        alpha = .5\r\n      ) +\r\n      stat_function(\r\n        fun = fun_pop,\r\n        geom = \"line\"\r\n      ) +\r\n      geom_segment(\r\n        aes(\r\n          x = rrt_pop, y = 0,\r\n          xend = rrt_pop, yend = Inf\r\n        ),\r\n        linetype = \"dashed\",\r\n        show.legend = FALSE\r\n      ) +\r\n      scale_color_manual(values = c(\r\n        \"TRUE\" = \"#1b9e77\",\r\n        \"FALSE\" = \"#d95f02\"\r\n      )) +\r\n      xlim(x_min, x_max) +\r\n      coord_flip() +\r\n      theme_bw() +\r\n      theme(\r\n        axis.title.x = element_blank(),\r\n        axis.text.x = element_blank(),\r\n        axis.ticks.x = element_blank(),\r\n        axis.title.y = element_blank(),\r\n        legend.position = \"none\"\r\n      ) +\r\n      labs(\r\n        y = \"Nilai\",\r\n        title = \"Distribusi populasi\"\r\n      )\r\n  })\r\n}\r\n\r\n# Membuat objek aplikasi Shiny ----\r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
