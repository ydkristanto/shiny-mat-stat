[{"name":"app.R","content":"library(shiny)\r\nlibrary(plotly)\r\nif (FALSE) {\r\n    library(igraph)\r\n}\r\n\r\n# Data ----\r\nactors <- data.frame(\r\n    name = 1:5,\r\n    label = c(\"Alice\", \"Bob\", \"Cecil\", \"David\", \"Esmeralda\"),\r\n    age = c(48, 33, 45, 34, 21),\r\n    gender = c(\"F\", \"M\", \"F\", \"M\", \"F\")\r\n)\r\nrelations <- data.frame(\r\n    from = c(2, 3, 3, 4, 4, 5),\r\n    to = c(1, 2, 1, 1, 2, 1),\r\n    same.dept = c(FALSE, FALSE, TRUE, FALSE, FALSE, TRUE),\r\n    friendship = c(4, 5, 5, 2, 1, 1), advice = c(4, 5, 5, 4, 2, 3)\r\n)\r\nG <- graph_from_data_frame(\r\n    relations, directed = FALSE, vertices = actors\r\n)\r\nL <- layout_nicely(G)\r\n\r\n# UI ----\r\nui <- fluidPage(\r\n    titlePanel(\"Reprex: Network Analysis\"),\r\n    sidebarLayout(\r\n        sidebarPanel(\r\n            selectInput(\r\n                \"nodes\",\r\n                \"Nodes:\",\r\n                c(letters[1:4]),\r\n                selected = letters[2:4],\r\n                multiple = TRUE,\r\n                selectize = TRUE\r\n            )\r\n        ),\r\n        mainPanel(\r\n           plotlyOutput(\"plot\")\r\n        )\r\n    )\r\n)\r\n\r\n# Server ----\r\nserver <- function(input, output) {\r\n    output$plot <- renderPlotly({\r\n        ## Create Vertices and Edges ----\r\n        vs <- V(G)\r\n        es <- as.data.frame(get.edgelist(G))\r\n        \r\n        Nv <- length(vs)\r\n        Ne <- length(es[1]$V1)\r\n        \r\n        ## Create Nodes ----\r\n        Xn <- L[,1]\r\n        Yn <- L[,2]\r\n        \r\n        network <- plot_ly(\r\n            x = ~Xn, y = ~Yn, mode = \"markers\",\r\n            text = vs$label, hoverinfo = \"text\"\r\n        )\r\n        \r\n        ## Creates Edges ----\r\n        edge_shapes <- list()\r\n        for(i in 1:Ne) {\r\n            v0 <- es[i,]$V1 |>\r\n                as.numeric()\r\n            v1 <- es[i,]$V2 |>\r\n                as.numeric()\r\n            \r\n            edge_shape = list(\r\n                type = \"line\",\r\n                line = list(color = \"#030303\", width = 0.3),\r\n                x0 = Xn[v0],\r\n                y0 = Yn[v0],\r\n                x1 = Xn[v1],\r\n                y1 = Yn[v1]\r\n            )\r\n            \r\n            edge_shapes[[i]] <- edge_shape\r\n        }\r\n        \r\n        ## Create Network ----\r\n        axis <- list(title = \"\", showgrid = FALSE, showticklabels = FALSE, zeroline = FALSE)\r\n        \r\n        fig <- layout(\r\n            network,\r\n            title = 'Karate Network',\r\n            shapes = edge_shapes,\r\n            xaxis = axis,\r\n            yaxis = axis\r\n        )\r\n        \r\n        fig\r\n    })\r\n}\r\n\r\n# Run the app ----\r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
