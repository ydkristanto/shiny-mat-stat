[{"name":"app.R","content":"# Paket ----\r\nlibrary(shiny)\r\nlibrary(tidyverse)\r\nlibrary(scales)\r\noptions(shiny.mathjax.url = \"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js\")\r\n\r\n# UI ----\r\nui <- navbarPage(\r\n  title = \"Ketegaran dan Kuasa Uji t dan Welch\",\r\n  ## Tab eksplorasi ----\r\n  tabPanel(\r\n    \"Eksplorasi\",\r\n    sidebarLayout(\r\n      ### Input ----\r\n      sidebarPanel(\r\n        wellPanel(\r\n          sliderInput(\"n_1\", \"Ukuran sampel 1:\",\r\n            min = 5, max = 50, value = 10, step = 1\r\n          ),\r\n          sliderInput(\"n_2\", \"Ukuran sampel 2:\",\r\n            min = 5, max = 50, value = 10, step = 1\r\n          ),\r\n          sliderInput(\"k_pasang\", \"Banyak pasangan sampel:\",\r\n            min = 20, max = 1000, value = 100, step = 1\r\n          )\r\n        ),\r\n        wellPanel(\r\n          sliderInput(\"mu_1\", \"Rerata populasi 1:\",\r\n            min = 45, max = 55, value = 50\r\n          ),\r\n          sliderInput(\"sigma_1\", \"Simpangan baku populasi 1:\",\r\n            min = 1, max = 20, value = 10\r\n          ),\r\n          hr(),\r\n          sliderInput(\"mu_2\", \"Rerata populasi 2:\",\r\n            min = 45, max = 55, value = 50\r\n          ),\r\n          sliderInput(\"sigma_2\", \"Simpangan baku populasi 2:\",\r\n            min = 1, max = 20, value = 10\r\n          )\r\n        ),\r\n        wellPanel(\r\n          selectInput(\"alternatif\", \"Hipotesis alternatif:\",\r\n            choices = c(\r\n              \"Tidak sama dengan\" = \"tak_sama\",\r\n              \"Lebih dari\" = \"lebih\",\r\n              \"Kurang dari\" = \"kurang\"\r\n            ),\r\n            selected = \"tak_sama\"\r\n          ),\r\n          hr(),\r\n          sliderInput(\"sig\", \"Tingkat signifikansi:\",\r\n            min = .01,\r\n            max = .2,\r\n            step = .01,\r\n            value = .05\r\n          )\r\n        )\r\n      ),\r\n      ### Panel utama ----\r\n      mainPanel(\r\n        tabsetPanel(\r\n          #### Populasi ----\r\n          tabPanel(\r\n            \"Populasi\",\r\n            br(),\r\n            plotOutput(\"plot_dist_pop\", height = \"480px\"),\r\n            textOutput(\"teks_dist_pop\"),\r\n            br()\r\n          ),\r\n          #### Beberapa sampel ----\r\n          tabPanel(\r\n            \"Beberapa Sampel\",\r\n            br(),\r\n            fluidRow(\r\n              column(\r\n                4,\r\n                br(),\r\n                plotOutput(\"plot_pasangan_1\",\r\n                  height = \"300px\"\r\n                )\r\n              ),\r\n              column(\r\n                4,\r\n                br(),\r\n                plotOutput(\"plot_pasangan_2\",\r\n                  height = \"300px\"\r\n                )\r\n              ),\r\n              column(\r\n                4,\r\n                br(),\r\n                plotOutput(\"plot_pasangan_3\",\r\n                  height = \"300px\"\r\n                )\r\n              )\r\n            ),\r\n            fluidRow(\r\n              column(\r\n                4,\r\n                br(),\r\n                plotOutput(\"plot_pasangan_4\",\r\n                  height = \"300px\"\r\n                )\r\n              ),\r\n              column(\r\n                4,\r\n                br(),\r\n                plotOutput(\"plot_pasangan_5\",\r\n                  height = \"300px\"\r\n                )\r\n              ),\r\n              column(\r\n                4,\r\n                br(),\r\n                plotOutput(\"plot_pasangan_6\",\r\n                  height = \"300px\"\r\n                )\r\n              )\r\n            ),\r\n            fluidRow(\r\n              column(\r\n                4,\r\n                br(),\r\n                plotOutput(\"plot_pasangan_7\",\r\n                  height = \"300px\"\r\n                )\r\n              ),\r\n              column(\r\n                4,\r\n                br(),\r\n                plotOutput(\"plot_pasangan_8\",\r\n                  height = \"300px\"\r\n                )\r\n              ),\r\n              column(\r\n                4,\r\n                br(),\r\n                plotOutput(\"plot_pasangan_9\",\r\n                  height = \"300px\"\r\n                )\r\n              )\r\n            ),\r\n            br(),\r\n            div(textOutput(\"teks_pasangan\"),\r\n              align = \"center\",\r\n              style = \"font-size: 1.1em\"\r\n            ),\r\n            br(),\r\n            textOutput(\"teks_gambar_pasangan\"),\r\n            br(),\r\n          ),\r\n          #### Distribusi sampling ----\r\n          tabPanel(\r\n            \"Distribusi Sampling\",\r\n            br(),\r\n            plotOutput(\"plot_dist_selisih_rerata\"),\r\n            textOutput(\"teks_dist_selisih_rerata\"),\r\n            br()\r\n          ),\r\n          #### Uji t klasik dan Welch ----\r\n          tabPanel(\r\n            \"Ketegaran dan Kuasa\",\r\n            withMathJax(),\r\n            br(),\r\n            conditionalPanel(\r\n              condition = \"input.alternatif == 'tak_sama'\",\r\n              div(\r\n                p(\"Hipotesis Nol dan Alternatifnya\",\r\n                  style = \"font-weight: bold;\"\r\n                ),\r\n                p(\"Hipotesis nol dan hipotesis alternatif dalam uji ini adalah sebagai berikut.\"),\r\n                tags$ul(\r\n                  tags$li(\"\\\\(H_0\\\\): Rerata kedua populasi sama. Hal ini dapat disimbolkan dengan \\\\( \\\\mu_1 = \\\\mu_2 \\\\) atau \\\\( \\\\mu_1 - \\\\mu_2 = 0 \\\\).\"),\r\n                  tags$li(\"\\\\(H_A\\\\): Rerata kedua populasi tersebut tidak sama, yaitu \\\\(\\\\mu_1 \\\\neq \\\\mu_2\\\\) atau \\\\( \\\\mu_1 - \\\\mu_2 \\\\neq 0 \\\\).\")\r\n                ),\r\n                style = \"padding: 10px; background-color: whitesmoke;\"\r\n              )\r\n            ),\r\n            conditionalPanel(\r\n              condition = \"input.alternatif == 'lebih'\",\r\n              div(\r\n                p(\"Hipotesis Nol dan Alternatifnya\",\r\n                  style = \"font-weight: bold;\"\r\n                ),\r\n                p(\"Hipotesis nol dan hipotesis alternatif dalam uji ini adalah sebagai berikut.\"),\r\n                tags$ul(\r\n                  tags$li(\"H_0: Rerata kedua populasi sama. Hal ini dapat disimbolkan dengan μ1 = μ2 atau μ1 - μ2 = 0.\"),\r\n                  tags$li(\"H_A: Rerata populasi pertama lebih dari populasi kedua, yaitu μ1 > μ2 atau μ1 - μ2 > 0.\")\r\n                ),\r\n                style = \"padding: 10px; background-color: whitesmoke;\"\r\n              )\r\n            ),\r\n            conditionalPanel(\r\n              condition = \"input.alternatif == 'kurang'\",\r\n              div(\r\n                p(\"Hipotesis Nol dan Alternatifnya\",\r\n                  style = \"font-weight: bold;\"\r\n                ),\r\n                p(\"Hipotesis nol dan hipotesis alternatif dalam uji ini adalah sebagai berikut.\"),\r\n                tags$ul(\r\n                  tags$li(\"H_0: Rerata kedua populasi sama. Hal ini dapat disimbolkan dengan μ1 = μ2 atau μ1 - μ2 = 0.\"),\r\n                  tags$li(\"H_A: Rerata populasi pertama kurang dari populasi kedua, yaitu μ1 < μ2 atau μ1 - μ2 < 0.\")\r\n                ),\r\n                style = \"padding: 10px; background-color: whitesmoke;\"\r\n              )\r\n            ),\r\n            br(),\r\n            plotOutput(\"plot_dist_stat\"),\r\n            textOutput(\"teks_dist_stat\"),\r\n            br(),\r\n            plotOutput(\"plot_perbandingan\"),\r\n            textOutput(\"teks_perbandingan\"),\r\n            hr(),\r\n            helpText(textOutput(\"teks_info_perbandingan\")),\r\n            br()\r\n          )\r\n        )\r\n      )\r\n    )\r\n  ),\r\n  ## Tab informasi ----\r\n  tabPanel(\r\n    \"Informasi\",\r\n    sidebarLayout(\r\n      sidebarPanel(\r\n        wellPanel(\r\n          div(h4(\"Deskripsi\",\r\n            style = \"font-size: inherit;\r\n                             font-weight: bold\"\r\n          )),\r\n          div(p(\"Aplikasi Shiny ini dapat digunakan untuk membandingkan ketegaran dan kuasa uji t klasik dan Welch.\"))\r\n        ),\r\n        wellPanel(\r\n          div(h4(\"Kode sumber\",\r\n            style = \"font-size: inherit;\r\n                             font-weight: bold\"\r\n          )),\r\n          div(p(\"Kode sumber aplikasi ini tersedia di\", a(\"repositori Github.\", href = \"https://github.com/ydkristanto/apl-uji-t-welch\", target = \"_blank\"), \"Jika Anda ingin melaporkan masalah atau meminta fitur tambahan terhadap aplikasi ini, silakan\", a(\"buat sebuah isu\", href = \"https://github.com/ydkristanto/apl-uji-t-welch/issues\", target = \"_blank\"), \"atau lebih baik lagi\", a(\"minta penarikan\", href = \"https://github.com/ydkristanto/apl-uji-t-welch/pulls\", target = \"_blank\"), \"di repositori tersebut.\"))\r\n        ),\r\n        wellPanel(\r\n          div(h4(\"Lisensi\",\r\n            style = \"font-size: inherit;\r\n                             font-weight: bold\"\r\n          )),\r\n          div(\r\n            p(\"Lisensi MIT\"),\r\n            p(\"Copyright (c) 2024 Yosep Dwi Kristanto\")\r\n          )\r\n        )\r\n      ),\r\n      mainPanel(\r\n        fluidRow(\r\n          column(\r\n            9,\r\n            div(h3(\"Aplikasi Shiny Ketegaran dan Kuasa Uji t Klasik dan Welch\")),\r\n            div(p(\"Aplikasi interaktif ini dapat digunakan untuk membandingkan dua jenis uji t dua sampel, yaitu uji t klasik dan uji t Welch. Kedua jenis uji t tersebut memiliki perbedaan dalam hal asumsi-asumsi statistiknya. Uji t klasik mengasumsikan homogenitas variansi sedangkan uji t Welch tidak.\"), align = \"justify\"),\r\n            div(p(\"Aplikasi ini menggunakan dua ukuran dalam membandingkan kedua uji t tersebut. Kedua ukuran tersebut adalah ketegaran dan kuasa ujinya. Ketegaran dapat dilihat pada galat jenis I. Kuasa uji dapat diselidiki ketika hipotesis nolnya salah. Hipotesis nol yang digunakan dalam aplikasi ini adalah bahwa kedua populasinya memiliki rerata yang sama.\"), align = \"justify\"),\r\n            hr(),\r\n            div(p(\"Aplikasi interaktif ini dikembangkan dengan menggunakan bahasa pemrogram\", a(\"R\", href = \"https://www.R-project.org/\", target = \"_blank\"), \"dan paket\", a(\"Shiny.\", href = \"https://CRAN.R-project.org/package=shiny\", target = \"_blank\"), \"Paket\", a(\"shinylive\", href = \"https://posit-dev.github.io/r-shinylive/\", target = \"_blank\"), \"digunakan untuk mengekspor aplikasi ini agar dapat dijalankan di peramban web tanpa peladen R yang terpisah.\"), align = \"justify\"),\r\n            div(p(\"Pengembang dan pemelihara aplikasi ini adalah\", a(\"Yosep Dwi Kristanto,\", href = \"https://people.usd.ac.id/~ydkristanto/\", target = \"_blank\"), \"seorang dosen dan peneliti di program studi\", a(\"Pendidikan Matematika,\", href = \"https://usd.ac.id/s1pmat\", target = \"_blank\"), a(\"Universitas Sanata Dharma,\", href = \"https://www.usd.ac.id/\", target = \"_blank\"), \"Yogyakarta.\"), align = \"justify\"),\r\n            hr(),\r\n            div(h4(\"Penafian tentang penggunaan AI:\",\r\n              style = \"font-size: inherit; font-weight: bold\"\r\n            )),\r\n            div(p(\"Perumusan kode-kode di balik aplikasi Shiny ini dibantu oleh kecerdasan buatan (AI) yang akurasinya selalu diawasi secara cermat oleh pengembang. Meskipun demikian, ide konseptual dan mendasar dari aplikasi ini orisinal dan dihasilkan oleh pengembang. Setiap potensi kesalahan atau keterbatasan dalam kode-kode tersebut menjadi tanggung jawab pengembang, dan bantuan AI diakui sebagai alat pendukung dalam proses pengembangan aplikasi ini.\"))\r\n          )\r\n          # di sini\r\n        )\r\n      )\r\n    )\r\n  )\r\n)\r\n\r\n\r\n# Fungsi peladen ----\r\nseed <- as.numeric(Sys.Date())\r\nserver <- function(input, output) {\r\n  # Mengatur pilihan hipotesis alternatif\r\n  observe({\r\n    mu_1 <- input$mu_1\r\n    mu_2 <- input$mu_2\r\n\r\n    if (mu_1 < mu_2) {\r\n      updateSelectInput(getDefaultReactiveDomain(), \"alternatif\",\r\n        choices = c(\r\n          \"Tidak sama dengan\" = \"tak_sama\",\r\n          \"Kurang dari\" = \"kurang\"\r\n        ),\r\n        selected = \"tak_sama\"\r\n      )\r\n    } else if (mu_1 > mu_2) {\r\n      updateSelectInput(getDefaultReactiveDomain(), \"alternatif\",\r\n        choices = c(\r\n          \"Tidak sama dengan\" = \"tak_sama\",\r\n          \"Lebih dari\" = \"lebih\"\r\n        ),\r\n        selected = \"tak_sama\"\r\n      )\r\n    } else {\r\n      updateSelectInput(getDefaultReactiveDomain(), \"alternatif\",\r\n        choices = c(\r\n          \"Tidak sama dengan\" = \"tak_sama\",\r\n          \"Lebih dari\" = \"lebih\",\r\n          \"Kurang dari\" = \"kurang\"\r\n        ),\r\n        selected = \"tak_sama\"\r\n      )\r\n    }\r\n  })\r\n\r\n  ## Fungsi set_sampel ----\r\n  set_sampel <- function(n1, n2, k, mu1, sigma1, mu2, sigma2) {\r\n    set.seed(seed)\r\n    # Membuat nilai-nilai sampel\r\n    matriks_nilai <- replicate(k, c(\r\n      rnorm(n1, mean = mu1, sd = sigma1),\r\n      rnorm(n2, mean = mu2, sd = sigma2)\r\n    ))\r\n    vektor_nilai <- round(c(matriks_nilai), 1)\r\n    # Membuat set sampel\r\n    data <- tibble(\r\n      id_sampel = rep(1:k, each = n1 + n2),\r\n      populasi = rep(c(rep(1, n1), rep(2, n2)), k),\r\n      nilai = vektor_nilai\r\n    )\r\n\r\n    return(data)\r\n  }\r\n\r\n  rep_set_sampel <- repeatable(set_sampel)\r\n\r\n  ## Fungsi stat_sampel ----\r\n  stat_sampel <- function(data, alternatif = \"tak_sama\") {\r\n    rangkuman <- data %>%\r\n      group_by(id_sampel, populasi) %>%\r\n      summarise(\r\n        n = n(),\r\n        mean = mean(nilai),\r\n        var = var(nilai),\r\n        .groups = \"drop\"\r\n      )\r\n    rangkuman_lebar <- rangkuman %>%\r\n      pivot_wider(names_from = populasi, values_from = c(n, mean, var))\r\n    data_stat <- rangkuman_lebar %>%\r\n      mutate(\r\n        selisih_mean = mean_1 - mean_2,\r\n        var_gabung = ((n_1 - 1) * var_1 + (n_2 - 1) * var_2) /\r\n          (n_1 + n_2 - 2),\r\n        A = var_1 / n_1,\r\n        B = var_2 / n_2\r\n      ) %>%\r\n      mutate(\r\n        df_klasik = n_1 + n_2 - 2,\r\n        df_welch = (A + B)^2 / (A^2 / (n_1 - 1) + B^2 / (n_2 - 1))\r\n      )\r\n    data_stat_panjang <- data_stat %>%\r\n      pivot_longer(\r\n        cols = c(df_klasik, df_welch),\r\n        names_to = \"uji_t\",\r\n        values_to = \"df\"\r\n      ) %>%\r\n      mutate(uji_t = ifelse(uji_t == \"df_klasik\", \"klasik\", \"welch\")) %>%\r\n      mutate(stat_uji = ifelse(uji_t == \"klasik\",\r\n        selisih_mean /\r\n          sqrt(var_gabung * (1 / n_1 + 1 / n_2)),\r\n        selisih_mean /\r\n          sqrt(var_1 / n_1 + var_2 / n_2)\r\n      ))\r\n\r\n    if (alternatif == \"tak_sama\") {\r\n      # Uji dua ekor\r\n      data_stat_panjang <- data_stat_panjang %>%\r\n        mutate(p = 2 * pt(-abs(stat_uji), df = df, lower.tail = TRUE)) %>%\r\n        select(id_sampel, n_1, n_2, selisih_mean, uji_t, df, stat_uji, p)\r\n    } else if (alternatif == \"lebih\") {\r\n      # Uji ekor kanan\r\n      data_stat_panjang <- data_stat_panjang %>%\r\n        mutate(p = pt(stat_uji, df = df, lower.tail = FALSE)) %>%\r\n        select(id_sampel, n_1, n_2, selisih_mean, uji_t, df, stat_uji, p)\r\n    } else if (alternatif == \"kurang\") {\r\n      # Uji ekor kiri\r\n      data_stat_panjang <- data_stat_panjang %>%\r\n        mutate(p = pt(stat_uji, df = df, lower.tail = TRUE)) %>%\r\n        select(id_sampel, n_1, n_2, selisih_mean, uji_t, df, stat_uji, p)\r\n    }\r\n\r\n    return(data_stat_panjang)\r\n  }\r\n\r\n  ## Fungsi komposisi ----\r\n  komposisi_data_stat <- function(n1, n2, k, mu1, sigma1,\r\n                                  mu2, sigma2, alternatif = \"tak_sama\") {\r\n    data_sampel <- rep_set_sampel(n1, n2, k, mu1, sigma1, mu2, sigma2)\r\n    data_stat <- stat_sampel(data_sampel, alternatif)\r\n\r\n    return(data_stat)\r\n  }\r\n\r\n  ## Fungsi reaktif ----\r\n  stat_set_sampel <- reactive({\r\n    komposisi_data_stat(\r\n      n1 = input$n_1, n2 = input$n_2, k = input$k_pasang,\r\n      mu1 = input$mu_1, sigma1 = input$sigma_1,\r\n      mu2 = input$mu_2, sigma2 = input$sigma_2,\r\n      alternatif = input$alternatif\r\n    )\r\n  })\r\n\r\n  ## Fungsi memilih pasangan acak ----\r\n  pilih_pasangan <- function(n, k) {\r\n    set.seed(seed)\r\n    id_pasangan <- sort(sample(1:k, n, replace = FALSE))\r\n    return(id_pasangan)\r\n  }\r\n\r\n  rep_pilih_pasangan <- repeatable(pilih_pasangan)\r\n\r\n  reak_pilih_pasangan <- reactive({\r\n    pilihan <- rep_pilih_pasangan(n = 9, k = input$k_pasang)\r\n    return(pilihan)\r\n  })\r\n\r\n  ## Plot distribusi populasi ----\r\n  output$plot_dist_pop <- renderPlot({\r\n    # Parameter populasi\r\n    mu_1 <- round(input$mu_1, 2)\r\n    sigma_1 <- round(input$sigma_1, 2)\r\n    mu_2 <- round(input$mu_2, 2)\r\n    sigma_2 <- round(input$sigma_2, 2)\r\n\r\n    # Batas plot\r\n    bts_ki <- min(mu_1 - 4 * sigma_1, mu_2 - 4 * sigma_2)\r\n    bts_ka <- max(mu_1 + 4 * sigma_1, mu_2 + 4 * sigma_2)\r\n\r\n    # Plot distribusi populasi\r\n    ggplot(data = data.frame(x = c(bts_ki, bts_ka)), aes(x = x)) +\r\n      stat_function(aes(fill = \"Populasi 2\"),\r\n        fun = dnorm, args = list(mean = mu_2, sd = sigma_2),\r\n        geom = \"area\", alpha = .3\r\n      ) +\r\n      stat_function(\r\n        fun = dnorm, args = list(mean = mu_2, sd = sigma_2),\r\n        geom = \"line\", linewidth = 1\r\n      ) +\r\n      stat_function(aes(fill = \"Populasi 1\"),\r\n        fun = dnorm, args = list(mean = mu_1, sd = sigma_1),\r\n        geom = \"area\", alpha = .3\r\n      ) +\r\n      stat_function(\r\n        fun = dnorm, args = list(mean = mu_1, sd = sigma_1),\r\n        geom = \"line\", linewidth = 1\r\n      ) +\r\n      theme_bw(base_size = 16) +\r\n      scale_fill_brewer(\r\n        palette = \"Dark2\",\r\n        name = \"Distribusi\"\r\n      ) +\r\n      theme(\r\n        legend.position = \"top\",\r\n        axis.title.y = element_blank(),\r\n        axis.text.y = element_blank(),\r\n        axis.ticks.y = element_blank(),\r\n        plot.title = element_text(face = \"bold\")\r\n      ) +\r\n      labs(\r\n        title = \"Distribusi Populasi\",\r\n        subtitle = paste0(\"Distribusi dua populasi N(\", mu_1, \", \", sigma_1, \"), dan N(\", mu_2, \", \", sigma_2, \").\"),\r\n        x = \"Nilai\"\r\n      )\r\n  })\r\n\r\n  ## Teks distribusi populasi ----\r\n  output$teks_dist_pop <- renderText({\r\n    mu_1 <- input$mu_1\r\n    sigma_1 <- input$sigma_1\r\n    mu_2 <- input$mu_2\r\n    sigma_2 <- input$sigma_2\r\n\r\n    paste0(\"Gambar 1: Distribusi dua populasi yang semuanya berdistribusi normal. Populasi pertama memiliki rerata \", mu_1, \" dan simpangan baku \", sigma_1, \" sedangkan rerata dan simpangan baku populasi kedua secara berturut-turut adalah \", mu_2, \" dan \", sigma_2, \".\")\r\n  })\r\n\r\n  ## Plot pasangan sampel 1 ----\r\n  output$plot_pasangan_1 <- renderPlot({\r\n    n1 <- input$n_1\r\n    n2 <- input$n_2\r\n    k <- input$k_pasang\r\n    mu1 <- input$mu_1\r\n    sigma1 <- input$sigma_1\r\n    mu2 <- input$mu_2\r\n    sigma2 <- input$sigma_2\r\n    pilihan <- reak_pilih_pasangan()\r\n\r\n    sampel <- rep_set_sampel(n1, n2, k, mu1, sigma1, mu2, sigma2) %>%\r\n      filter(id_sampel == pilihan[1])\r\n    data_rerata <- sampel %>%\r\n      group_by(populasi) %>%\r\n      summarise(mean = mean(nilai))\r\n    selisih_rerata <- round(data_rerata$mean[1] -\r\n      data_rerata$mean[2], 2)\r\n\r\n    sampel %>%\r\n      ggplot(aes(\r\n        y = nilai, x = factor(populasi),\r\n        color = factor(populasi)\r\n      )) +\r\n      geom_violin() +\r\n      geom_crossbar(stat = \"summary\", color = \"black\") +\r\n      geom_point(\r\n        position = position_jitter(width = .2),\r\n        size = 4, alpha = .6\r\n      ) +\r\n      stat_summary(fun = mean, color = \"darkred\", size = 1) +\r\n      scale_color_brewer(\r\n        palette = \"Dark2\",\r\n        name = \"Sampel\"\r\n      ) +\r\n      theme_bw(base_size = 14) +\r\n      theme(legend.position = \"none\") +\r\n      labs(\r\n        x = \"Sampel\", y = \"Nilai\",\r\n        subtitle = paste0(\"Selisih rerata = \", selisih_rerata)\r\n      )\r\n  })\r\n\r\n  ## Plot pasangan sampel 2 ----\r\n  output$plot_pasangan_2 <- renderPlot({\r\n    n1 <- input$n_1\r\n    n2 <- input$n_2\r\n    k <- input$k_pasang\r\n    mu1 <- input$mu_1\r\n    sigma1 <- input$sigma_1\r\n    mu2 <- input$mu_2\r\n    sigma2 <- input$sigma_2\r\n    pilihan <- reak_pilih_pasangan()\r\n\r\n    sampel <- rep_set_sampel(n1, n2, k, mu1, sigma1, mu2, sigma2) %>%\r\n      filter(id_sampel == pilihan[2])\r\n    data_rerata <- sampel %>%\r\n      group_by(populasi) %>%\r\n      summarise(mean = mean(nilai))\r\n    selisih_rerata <- round(data_rerata$mean[1] -\r\n      data_rerata$mean[2], 2)\r\n\r\n    sampel %>%\r\n      ggplot(aes(\r\n        y = nilai, x = factor(populasi),\r\n        color = factor(populasi)\r\n      )) +\r\n      geom_violin() +\r\n      geom_crossbar(stat = \"summary\", color = \"black\") +\r\n      geom_point(\r\n        position = position_jitter(width = .2),\r\n        size = 4, alpha = .6\r\n      ) +\r\n      stat_summary(fun = mean, color = \"darkred\", size = 1) +\r\n      scale_color_brewer(\r\n        palette = \"Dark2\",\r\n        name = \"Sampel\"\r\n      ) +\r\n      theme_bw(base_size = 14) +\r\n      theme(legend.position = \"none\") +\r\n      labs(\r\n        x = \"Sampel\", y = \"Nilai\",\r\n        subtitle = paste0(\"Selisih rerata = \", selisih_rerata)\r\n      )\r\n  })\r\n\r\n  ## Plot pasangan sampel 3 ----\r\n  output$plot_pasangan_3 <- renderPlot({\r\n    n1 <- input$n_1\r\n    n2 <- input$n_2\r\n    k <- input$k_pasang\r\n    mu1 <- input$mu_1\r\n    sigma1 <- input$sigma_1\r\n    mu2 <- input$mu_2\r\n    sigma2 <- input$sigma_2\r\n    pilihan <- reak_pilih_pasangan()\r\n\r\n    sampel <- rep_set_sampel(n1, n2, k, mu1, sigma1, mu2, sigma2) %>%\r\n      filter(id_sampel == pilihan[3])\r\n    data_rerata <- sampel %>%\r\n      group_by(populasi) %>%\r\n      summarise(mean = mean(nilai))\r\n    selisih_rerata <- round(data_rerata$mean[1] -\r\n      data_rerata$mean[2], 2)\r\n\r\n    sampel %>%\r\n      ggplot(aes(\r\n        y = nilai, x = factor(populasi),\r\n        color = factor(populasi)\r\n      )) +\r\n      geom_violin() +\r\n      geom_crossbar(stat = \"summary\", color = \"black\") +\r\n      geom_point(\r\n        position = position_jitter(width = .2),\r\n        size = 4, alpha = .6\r\n      ) +\r\n      stat_summary(fun = mean, color = \"darkred\", size = 1) +\r\n      scale_color_brewer(\r\n        palette = \"Dark2\",\r\n        name = \"Sampel\"\r\n      ) +\r\n      theme_bw(base_size = 14) +\r\n      theme(legend.position = \"none\") +\r\n      labs(\r\n        x = \"Sampel\", y = \"Nilai\",\r\n        subtitle = paste0(\"Selisih rerata = \", selisih_rerata)\r\n      )\r\n  })\r\n\r\n  ## Plot pasangan sampel 4 ----\r\n  output$plot_pasangan_4 <- renderPlot({\r\n    n1 <- input$n_1\r\n    n2 <- input$n_2\r\n    k <- input$k_pasang\r\n    mu1 <- input$mu_1\r\n    sigma1 <- input$sigma_1\r\n    mu2 <- input$mu_2\r\n    sigma2 <- input$sigma_2\r\n    pilihan <- reak_pilih_pasangan()\r\n\r\n    sampel <- rep_set_sampel(n1, n2, k, mu1, sigma1, mu2, sigma2) %>%\r\n      filter(id_sampel == pilihan[4])\r\n    data_rerata <- sampel %>%\r\n      group_by(populasi) %>%\r\n      summarise(mean = mean(nilai))\r\n    selisih_rerata <- round(data_rerata$mean[1] -\r\n      data_rerata$mean[2], 2)\r\n\r\n    sampel %>%\r\n      ggplot(aes(\r\n        y = nilai, x = factor(populasi),\r\n        color = factor(populasi)\r\n      )) +\r\n      geom_violin() +\r\n      geom_crossbar(stat = \"summary\", color = \"black\") +\r\n      geom_point(\r\n        position = position_jitter(width = .2),\r\n        size = 4, alpha = .6\r\n      ) +\r\n      stat_summary(fun = mean, color = \"darkred\", size = 1) +\r\n      scale_color_brewer(\r\n        palette = \"Dark2\",\r\n        name = \"Sampel\"\r\n      ) +\r\n      theme_bw(base_size = 14) +\r\n      theme(legend.position = \"none\") +\r\n      labs(\r\n        x = \"Sampel\", y = \"Nilai\",\r\n        subtitle = paste0(\"Selisih rerata = \", selisih_rerata)\r\n      )\r\n  })\r\n\r\n  ## Plot pasangan sampel 5 ----\r\n  output$plot_pasangan_5 <- renderPlot({\r\n    n1 <- input$n_1\r\n    n2 <- input$n_2\r\n    k <- input$k_pasang\r\n    mu1 <- input$mu_1\r\n    sigma1 <- input$sigma_1\r\n    mu2 <- input$mu_2\r\n    sigma2 <- input$sigma_2\r\n    pilihan <- reak_pilih_pasangan()\r\n\r\n    sampel <- rep_set_sampel(n1, n2, k, mu1, sigma1, mu2, sigma2) %>%\r\n      filter(id_sampel == pilihan[5])\r\n    data_rerata <- sampel %>%\r\n      group_by(populasi) %>%\r\n      summarise(mean = mean(nilai))\r\n    selisih_rerata <- round(data_rerata$mean[1] -\r\n      data_rerata$mean[2], 2)\r\n\r\n    sampel %>%\r\n      ggplot(aes(\r\n        y = nilai, x = factor(populasi),\r\n        color = factor(populasi)\r\n      )) +\r\n      geom_violin() +\r\n      geom_crossbar(stat = \"summary\", color = \"black\") +\r\n      geom_point(\r\n        position = position_jitter(width = .2),\r\n        size = 4, alpha = .6\r\n      ) +\r\n      stat_summary(fun = mean, color = \"darkred\", size = 1) +\r\n      scale_color_brewer(\r\n        palette = \"Dark2\",\r\n        name = \"Sampel\"\r\n      ) +\r\n      theme_bw(base_size = 14) +\r\n      theme(legend.position = \"none\") +\r\n      labs(\r\n        x = \"Sampel\", y = \"Nilai\",\r\n        subtitle = paste0(\"Selisih rerata = \", selisih_rerata)\r\n      )\r\n  })\r\n\r\n  ## Plot pasangan sampel 6 ----\r\n  output$plot_pasangan_6 <- renderPlot({\r\n    n1 <- input$n_1\r\n    n2 <- input$n_2\r\n    k <- input$k_pasang\r\n    mu1 <- input$mu_1\r\n    sigma1 <- input$sigma_1\r\n    mu2 <- input$mu_2\r\n    sigma2 <- input$sigma_2\r\n    pilihan <- reak_pilih_pasangan()\r\n\r\n    sampel <- rep_set_sampel(n1, n2, k, mu1, sigma1, mu2, sigma2) %>%\r\n      filter(id_sampel == pilihan[5])\r\n    data_rerata <- sampel %>%\r\n      group_by(populasi) %>%\r\n      summarise(mean = mean(nilai))\r\n    selisih_rerata <- round(data_rerata$mean[1] -\r\n      data_rerata$mean[2], 2)\r\n\r\n    sampel %>%\r\n      ggplot(aes(\r\n        y = nilai, x = factor(populasi),\r\n        color = factor(populasi)\r\n      )) +\r\n      geom_violin() +\r\n      geom_crossbar(stat = \"summary\", color = \"black\") +\r\n      geom_point(\r\n        position = position_jitter(width = .2),\r\n        size = 4, alpha = .6\r\n      ) +\r\n      stat_summary(fun = mean, color = \"darkred\", size = 1) +\r\n      scale_color_brewer(\r\n        palette = \"Dark2\",\r\n        name = \"Sampel\"\r\n      ) +\r\n      theme_bw(base_size = 14) +\r\n      theme(legend.position = \"none\") +\r\n      labs(\r\n        x = \"Sampel\", y = \"Nilai\",\r\n        subtitle = paste0(\"Selisih rerata = \", selisih_rerata)\r\n      )\r\n  })\r\n\r\n  ## Plot pasangan sampel 7 ----\r\n  output$plot_pasangan_7 <- renderPlot({\r\n    n1 <- input$n_1\r\n    n2 <- input$n_2\r\n    k <- input$k_pasang\r\n    mu1 <- input$mu_1\r\n    sigma1 <- input$sigma_1\r\n    mu2 <- input$mu_2\r\n    sigma2 <- input$sigma_2\r\n    pilihan <- reak_pilih_pasangan()\r\n\r\n    sampel <- rep_set_sampel(n1, n2, k, mu1, sigma1, mu2, sigma2) %>%\r\n      filter(id_sampel == pilihan[7])\r\n    data_rerata <- sampel %>%\r\n      group_by(populasi) %>%\r\n      summarise(mean = mean(nilai))\r\n    selisih_rerata <- round(data_rerata$mean[1] -\r\n      data_rerata$mean[2], 2)\r\n\r\n    sampel %>%\r\n      ggplot(aes(\r\n        y = nilai, x = factor(populasi),\r\n        color = factor(populasi)\r\n      )) +\r\n      geom_violin() +\r\n      geom_crossbar(stat = \"summary\", color = \"black\") +\r\n      geom_point(\r\n        position = position_jitter(width = .2),\r\n        size = 4, alpha = .6\r\n      ) +\r\n      stat_summary(fun = mean, color = \"darkred\", size = 1) +\r\n      scale_color_brewer(\r\n        palette = \"Dark2\",\r\n        name = \"Sampel\"\r\n      ) +\r\n      theme_bw(base_size = 14) +\r\n      theme(legend.position = \"none\") +\r\n      labs(\r\n        x = \"Sampel\", y = \"Nilai\",\r\n        subtitle = paste0(\"Selisih rerata = \", selisih_rerata)\r\n      )\r\n  })\r\n\r\n  ## Plot pasangan sampel 8 ----\r\n  output$plot_pasangan_8 <- renderPlot({\r\n    n1 <- input$n_1\r\n    n2 <- input$n_2\r\n    k <- input$k_pasang\r\n    mu1 <- input$mu_1\r\n    sigma1 <- input$sigma_1\r\n    mu2 <- input$mu_2\r\n    sigma2 <- input$sigma_2\r\n    pilihan <- reak_pilih_pasangan()\r\n\r\n    sampel <- rep_set_sampel(n1, n2, k, mu1, sigma1, mu2, sigma2) %>%\r\n      filter(id_sampel == pilihan[8])\r\n    data_rerata <- sampel %>%\r\n      group_by(populasi) %>%\r\n      summarise(mean = mean(nilai))\r\n    selisih_rerata <- round(data_rerata$mean[1] -\r\n      data_rerata$mean[2], 2)\r\n\r\n    sampel %>%\r\n      ggplot(aes(\r\n        y = nilai, x = factor(populasi),\r\n        color = factor(populasi)\r\n      )) +\r\n      geom_violin() +\r\n      geom_crossbar(stat = \"summary\", color = \"black\") +\r\n      geom_point(\r\n        position = position_jitter(width = .2),\r\n        size = 4, alpha = .6\r\n      ) +\r\n      stat_summary(fun = mean, color = \"darkred\", size = 1) +\r\n      scale_color_brewer(\r\n        palette = \"Dark2\",\r\n        name = \"Sampel\"\r\n      ) +\r\n      theme_bw(base_size = 14) +\r\n      theme(legend.position = \"none\") +\r\n      labs(\r\n        x = \"Sampel\", y = \"Nilai\",\r\n        subtitle = paste0(\"Selisih rerata = \", selisih_rerata)\r\n      )\r\n  })\r\n\r\n  ## Plot pasangan sampel 9 ----\r\n  output$plot_pasangan_9 <- renderPlot({\r\n    n1 <- input$n_1\r\n    n2 <- input$n_2\r\n    k <- input$k_pasang\r\n    mu1 <- input$mu_1\r\n    sigma1 <- input$sigma_1\r\n    mu2 <- input$mu_2\r\n    sigma2 <- input$sigma_2\r\n    pilihan <- reak_pilih_pasangan()\r\n\r\n    sampel <- rep_set_sampel(n1, n2, k, mu1, sigma1, mu2, sigma2) %>%\r\n      filter(id_sampel == pilihan[9])\r\n    data_rerata <- sampel %>%\r\n      group_by(populasi) %>%\r\n      summarise(mean = mean(nilai))\r\n    selisih_rerata <- round(data_rerata$mean[1] -\r\n      data_rerata$mean[2], 2)\r\n\r\n    sampel %>%\r\n      ggplot(aes(\r\n        y = nilai, x = factor(populasi),\r\n        color = factor(populasi)\r\n      )) +\r\n      geom_violin() +\r\n      geom_crossbar(stat = \"summary\", color = \"black\") +\r\n      geom_point(\r\n        position = position_jitter(width = .2),\r\n        size = 4, alpha = .6\r\n      ) +\r\n      stat_summary(fun = mean, color = \"darkred\", size = 1) +\r\n      scale_color_brewer(\r\n        palette = \"Dark2\",\r\n        name = \"Sampel\"\r\n      ) +\r\n      theme_bw(base_size = 14) +\r\n      theme(legend.position = \"none\") +\r\n      labs(\r\n        x = \"Sampel\", y = \"Nilai\",\r\n        subtitle = paste0(\"Selisih rerata = \", selisih_rerata)\r\n      )\r\n  })\r\n\r\n  ## Teks pasangan sampel ----\r\n  output$teks_pasangan <- renderText({\r\n    k <- input$k_pasang\r\n    paste0(\"... dan seterusnya sampai sampel ke-\", k, \".\")\r\n  })\r\n\r\n  ## Teks gambar pasangan sampel ----\r\n  output$teks_gambar_pasangan <- renderText({\r\n    n1 <- input$n_1\r\n    n2 <- input$n_2\r\n    k <- input$k_pasang\r\n    mu1 <- input$mu_1\r\n    sigma1 <- input$sigma_1\r\n    mu2 <- input$mu_2\r\n    sigma2 <- input$sigma_2\r\n    pilihan <- reak_pilih_pasangan()\r\n\r\n    sampel <- rep_set_sampel(n1, n2, k, mu1, sigma1, mu2, sigma2) %>%\r\n      filter(id_sampel %in% pilihan)\r\n    data_rerata <- sampel %>%\r\n      group_by(id_sampel, populasi) %>%\r\n      summarise(mean = mean(nilai)) %>%\r\n      summarise(selisih = round(-diff(mean), 2), .groups = \"drop\")\r\n    vektor_rerata <- c(data_rerata$selisih)\r\n\r\n    paste0(\r\n      \"Gambar 2: Distribusi nilai sembilan dari \", k, \" pasang sampel yang disertai dengan selisih reratanya. Selisih rerata tersebut secara berturut-turut adalah \",\r\n      vektor_rerata[1], \", \",\r\n      vektor_rerata[2], \", \",\r\n      vektor_rerata[3], \", \",\r\n      vektor_rerata[4], \", \",\r\n      vektor_rerata[5], \", \",\r\n      vektor_rerata[6], \", \",\r\n      vektor_rerata[7], \", \",\r\n      vektor_rerata[8], \", dan \",\r\n      vektor_rerata[9], \".\"\r\n    )\r\n  })\r\n\r\n  ## Plot distribusi sampling selisih rerata ----\r\n  output$plot_dist_selisih_rerata <- renderPlot({\r\n    # Memanggil nilai input\r\n    sig <- input$sig\r\n    k <- input$k_pasang\r\n    n_1 <- input$n_1\r\n    n_2 <- input$n_2\r\n    mu_1 <- input$mu_1\r\n    sigma_1 <- input$sigma_1\r\n    mu_2 <- input$mu_2\r\n    sigma_2 <- input$sigma_2\r\n\r\n    selisih_mu <- mu_1 - mu_2\r\n    se <- sqrt(sigma_1^2 / n_1 + sigma_2^2 / n_2)\r\n\r\n    # Membuat data\r\n    data_stat <- stat_set_sampel() %>%\r\n      filter(uji_t == \"klasik\")\r\n\r\n    data_stat %>%\r\n      ggplot(aes(x = selisih_mean)) +\r\n      geom_histogram(aes(y = after_stat(density)),\r\n        color = \"white\", alpha = .8\r\n      ) +\r\n      stat_function(\r\n        fun = dnorm, args = list(\r\n          mean = selisih_mu,\r\n          sd = se\r\n        ),\r\n        linewidth = 1.5\r\n      ) +\r\n      theme_bw(base_size = 16) +\r\n      theme(plot.title = element_text(face = \"bold\")) +\r\n      labs(\r\n        title = \"Distribusi Sampling Selisih Rerata\",\r\n        x = \"Selisih rerata\"\r\n      )\r\n  })\r\n\r\n  ## Teks distribusi sampling selisih rerata ----\r\n  output$teks_dist_selisih_rerata <- renderText({\r\n    k <- input$k_pasang\r\n    data_stat <- stat_set_sampel() %>%\r\n      filter(uji_t == \"klasik\")\r\n    ringkasan <- data_stat %>%\r\n      summarise(\r\n        n = n(),\r\n        mean = mean(selisih_mean),\r\n        sd = sd(selisih_mean)\r\n      )\r\n\r\n    paste0(\"Gambar 3: Distribusi selisih rerata dari \", k, \" pasang sampel. Selisih rerata tersebut kurang lebih berdistribusi normal dengan rerata \", round(ringkasan$mean, 2), \" dan simpangan baku \", round(ringkasan$sd, 2), \".\")\r\n  })\r\n\r\n  ## Plot distribusi t ----\r\n  output$plot_dist_stat <- renderPlot({\r\n    sig <- input$sig\r\n    k <- input$k_pasang\r\n    n_1 <- input$n_1\r\n    n_2 <- input$n_2\r\n    mu_1 <- input$mu_1\r\n    sigma_1 <- input$sigma_1\r\n    mu_2 <- input$mu_2\r\n    sigma_2 <- input$sigma_2\r\n    selisih_mu <- mu_1 - mu_2\r\n    se <- sqrt(sigma_1^2 / n_1 + sigma_2^2 / n_2)\r\n\r\n    dist_selisih_baku <- function(x) {\r\n      dnorm(se * x, mean = selisih_mu, sd = se) * se\r\n    }\r\n\r\n    alfa_ruas <- function(x) {\r\n      1 / 1372000 * (x - 1000)^2 + 3 / 10\r\n    }\r\n\r\n    data_stat <- stat_set_sampel() %>%\r\n      mutate(p_signif = p <= sig)\r\n    data_df <- data_stat %>%\r\n      filter(uji_t == \"welch\") %>%\r\n      summarise(\r\n        min = min(df),\r\n        med = median(df),\r\n        maks = max(df)\r\n      )\r\n\r\n    # Plot distribusi\r\n    if (mu_1 == mu_2) {\r\n      data_stat %>%\r\n        ggplot(aes(color = factor(p_signif))) +\r\n        geom_segment(\r\n          aes(\r\n            x = stat_uji, xend = stat_uji,\r\n            y = 0, yend = Inf\r\n          ),\r\n          linewidth = 1, alpha = alfa_ruas(k)\r\n        ) +\r\n        stat_function(\r\n          fun = dt, args = list(df = n_1 + n_2 - 2),\r\n          linewidth = 1.5, color = \"black\",\r\n          data = subset(data_stat, uji_t == \"klasik\")\r\n        ) +\r\n        stat_function(\r\n          fun = dt, args = list(df = data_df$min[1]),\r\n          linewidth = 1, color = \"black\", alpha = .4,\r\n          data = subset(data_stat, uji_t == \"welch\")\r\n        ) +\r\n        stat_function(\r\n          fun = dt, args = list(df = data_df$med[1]),\r\n          linewidth = 1, color = \"black\", alpha = .8,\r\n          data = subset(data_stat, uji_t == \"welch\")\r\n        ) +\r\n        stat_function(\r\n          fun = dt, args = list(df = data_df$maks[1]),\r\n          linewidth = 1, color = \"black\", alpha = .4,\r\n          data = subset(data_stat, uji_t == \"welch\")\r\n        ) +\r\n        geom_point(aes(x = stat_uji, y = 0),\r\n          alpha = alfa_ruas(k),\r\n          size = 3, position = position_jitter(height = .03)\r\n        ) +\r\n        ylim(-.1, .5) +\r\n        facet_grid(uji_t ~ .) +\r\n        theme_bw(base_size = 16) +\r\n        scale_color_manual(\r\n          name = \"Menolak H_0\",\r\n          labels = c(\r\n            \"TRUE\" = \"Ya\",\r\n            \"FALSE\" = \"Tidak\"\r\n          ),\r\n          values = c(\r\n            \"TRUE\" = \"#d95f02\",\r\n            \"FALSE\" = \"#1b9e77\"\r\n          )\r\n        ) +\r\n        theme(\r\n          legend.position = \"top\",\r\n          axis.title.y = element_blank(),\r\n          axis.text.y = element_blank(),\r\n          axis.ticks.y = element_blank(),\r\n          plot.title = element_text(face = \"bold\")\r\n        ) +\r\n        labs(\r\n          title = \"Distribusi Statistik t\",\r\n          x = \"t\"\r\n        )\r\n    } else {\r\n      data_stat %>%\r\n        ggplot(aes(color = factor(p_signif))) +\r\n        geom_segment(\r\n          aes(\r\n            x = stat_uji, xend = stat_uji,\r\n            y = 0, yend = Inf\r\n          ),\r\n          linewidth = 1, alpha = alfa_ruas(k)\r\n        ) +\r\n        stat_function(\r\n          fun = dt, args = list(df = n_1 + n_2 - 2),\r\n          linewidth = 1.5, color = \"black\",\r\n          data = subset(data_stat, uji_t == \"klasik\")\r\n        ) +\r\n        stat_function(\r\n          fun = dt, args = list(df = data_df$min[1]),\r\n          linewidth = 1, color = \"black\", alpha = .4,\r\n          data = subset(data_stat, uji_t == \"welch\")\r\n        ) +\r\n        stat_function(\r\n          fun = dt, args = list(df = data_df$med[1]),\r\n          linewidth = 1, color = \"black\", alpha = .8,\r\n          data = subset(data_stat, uji_t == \"welch\")\r\n        ) +\r\n        stat_function(\r\n          fun = dt, args = list(df = data_df$maks[1]),\r\n          linewidth = 1, color = \"black\", alpha = .4,\r\n          data = subset(data_stat, uji_t == \"welch\")\r\n        ) +\r\n        stat_function(\r\n          fun = dist_selisih_baku,\r\n          linewidth = 1.5,\r\n          color = \"blue\"\r\n        ) +\r\n        geom_point(aes(x = stat_uji, y = 0),\r\n          alpha = alfa_ruas(k),\r\n          size = 3, position = position_jitter(height = .03)\r\n        ) +\r\n        ylim(-.1, .5) +\r\n        facet_grid(uji_t ~ .) +\r\n        theme_bw(base_size = 16) +\r\n        scale_color_manual(\r\n          name = \"Menolak H_0\",\r\n          labels = c(\r\n            \"TRUE\" = \"Ya\",\r\n            \"FALSE\" = \"Tidak\"\r\n          ),\r\n          values = c(\r\n            \"TRUE\" = \"#d95f02\",\r\n            \"FALSE\" = \"#1b9e77\"\r\n          )\r\n        ) +\r\n        theme(\r\n          legend.position = \"top\",\r\n          axis.title.y = element_blank(),\r\n          axis.text.y = element_blank(),\r\n          axis.ticks.y = element_blank(),\r\n          plot.title = element_text(face = \"bold\")\r\n        ) +\r\n        labs(\r\n          title = \"Distribusi Statistik t\",\r\n          x = \"t\"\r\n        )\r\n    }\r\n  })\r\n\r\n  ## Teks distribusi t ----\r\n  output$teks_dist_stat <- renderText({\r\n    sig <- input$sig\r\n    data_stat <- stat_set_sampel() %>%\r\n      mutate(p_signif = p <= sig)\r\n    stat_signif <- data_stat %>%\r\n      group_by(uji_t) %>%\r\n      summarise(persen_menolak = mean(p_signif) * 100)\r\n    persen_klasik <- round(stat_signif$persen_menolak[1], 2)\r\n    persen_welch <- round(stat_signif$persen_menolak[2], 2)\r\n\r\n    paste0(\"Gambar 4.a: Statistik t dari selisih rerata setiap pasangan sampel yang dipilih secara acak dari populasi pertama dan kedua. Dengan tingkat signifikansi \", sig, \", persentase penolakan hipotesis nol ketika menggunakan uji t klasik adalah \", persen_klasik, \"%. Ketika menggunakan uji Welch, persentasenya adalah \", persen_welch, \"%.\")\r\n  })\r\n\r\n  ## Plot perbandingan ----\r\n  output$plot_perbandingan <- renderPlot({\r\n    sig <- input$sig\r\n    data_stat <- stat_set_sampel() %>%\r\n      mutate(p_signif = p <= sig)\r\n    ringkasan <- data_stat %>%\r\n      group_by(uji_t) %>%\r\n      summarise(signif = mean(p_signif)) %>%\r\n      mutate(persen_signif = paste0(round(signif * 100, 2), \"%\"))\r\n\r\n    x_maks <- max(ringkasan$signif, sig)\r\n    x_min <- min(ringkasan$signif, sig)\r\n    x_range <- x_maks - x_min\r\n    plot_range <- c(\r\n      x_min - x_range / 4,\r\n      x_maks + x_range / 4\r\n    )\r\n\r\n    slsh_persen <- round(abs(ringkasan$signif[1] -\r\n      ringkasan$signif[2]) * 100, 2)\r\n    pos_x <- min(ringkasan$signif[1], ringkasan$signif[2]) +\r\n      slsh_persen / 200\r\n\r\n    ggplot(ringkasan) +\r\n      geom_segment(\r\n        aes(\r\n          x = signif, xend = sig,\r\n          y = uji_t, yend = uji_t,\r\n          col = uji_t\r\n        ),\r\n        show.legend = FALSE, linewidth = 5,\r\n        alpha = .6\r\n      ) +\r\n      geom_segment(\r\n        aes(\r\n          x = sig, xend = sig,\r\n          y = 0, yend = Inf\r\n        ),\r\n        linewidth = 3, alpha = .6\r\n      ) +\r\n      geom_segment(\r\n        aes(\r\n          x = signif[1], xend = signif[2],\r\n          y = factor(1), yend = factor(1)\r\n        ),\r\n        show.legend = FALSE, linewidth = 5, color = \"#7570b3\",\r\n        alpha = .2\r\n      ) +\r\n      geom_point(aes(x = signif, y = factor(1)),\r\n        size = 8, color = \"#7570b3\"\r\n      ) +\r\n      geom_point(\r\n        aes(\r\n          x = signif,\r\n          y = uji_t,\r\n          col = uji_t\r\n        ),\r\n        size = 8\r\n      ) +\r\n      geom_label(\r\n        aes(\r\n          x = signif, y = uji_t,\r\n          label = persen_signif, col = uji_t\r\n        ),\r\n        fill = \"white\", fontface = \"bold\", size = 5,\r\n        nudge_y = .25, label.r = unit(0.1, \"lines\"),\r\n        show.legend = FALSE\r\n      ) +\r\n      geom_label(\r\n        aes(\r\n          x = pos_x, y = factor(1),\r\n          label = paste0(slsh_persen, \"%\")\r\n        ),\r\n        color = \"#7570b3\", fill = \"white\", fontface = \"bold\",\r\n        size = 5, label.r = unit(0.1, \"lines\"),\r\n        show.legend = FALSE\r\n      ) +\r\n      scale_x_continuous(\r\n        labels = label_percent(scale = 100),\r\n        limits = plot_range\r\n      ) +\r\n      scale_color_brewer(palette = \"Dark2\", name = \"Distribusi sampling\") +\r\n      theme_bw(base_size = 16) +\r\n      theme(\r\n        legend.position = \"top\",\r\n        axis.title.y = element_blank(),\r\n        axis.text.y = element_blank(),\r\n        axis.ticks.y = element_blank(),\r\n        plot.title = element_text(face = \"bold\")\r\n      ) +\r\n      labs(\r\n        title = \"Selisih Persentase Penolakan Hipotesis Nol\",\r\n        x = \"Persentase\"\r\n      )\r\n  })\r\n\r\n\r\n  ## Teks perbandingan ----\r\n  output$teks_perbandingan <- renderText({\r\n    mu_1 <- input$mu_1\r\n    mu_2 <- input$mu_2\r\n    sig <- input$sig\r\n    data_stat <- stat_set_sampel() %>%\r\n      mutate(p_signif = p <= sig)\r\n    ringkasan <- data_stat %>%\r\n      group_by(uji_t) %>%\r\n      summarise(signif = mean(p_signif)) %>%\r\n      mutate(persen_signif = paste0(round(signif * 100, 2), \"%\"))\r\n\r\n    slsh_persen <- round(abs(ringkasan$signif[1] -\r\n      ringkasan$signif[2]) * 100, 2)\r\n\r\n    if (mu_1 == mu_2) {\r\n      if (ringkasan$signif[1] == ringkasan$signif[2]) {\r\n        \"Gambar 4.b: Selisih persentase penolakan hipotesis nol dari uji t klasik dan uji t Welch adalah 0%. Kedua uji ini memiliki persentase galat tipe I* yang sama.\"\r\n      } else if (ringkasan$signif[1] < ringkasan$signif[2]) {\r\n        paste0(\"Gambar 4.b: Persentase penolakan hipotesis nol dari uji t klasik \", slsh_persen, \"% kurang dari uji t Welch. Dengan demikian, dalam simulasi ini uji t klasik lebih baik dibandingkan uji t Welch karena memiliki galat tipe I* yang lebih kecil.\")\r\n      } else {\r\n        paste0(\"Gambar 4.b: Persentase penolakan hipotesis nol dari uji t Welch \", slsh_persen, \"% lebih kecil dari uji t klasik. Dengan demikian, dalam simulasi ini uji t Welch lebih baik dibandingkan uji t klasik karena memiliki galat tipe I* yang lebih kecil.\")\r\n      }\r\n    } else {\r\n      if (ringkasan$signif[1] == ringkasan$signif[2]) {\r\n        \"Gambar 4.b: Selisih persentase penolakan hipotesis nol dari uji t klasik dan uji t Welch adalah 0%. Kedua uji ini memiliki kuasa* yang sama.\"\r\n      } else if (ringkasan$signif[1] < ringkasan$signif[2]) {\r\n        paste0(\"Gambar 4.b: Persentase penolakan hipotesis nol dari uji t Welch \", slsh_persen, \"% lebih dari uji t klasik. Dengan demikian, dalam simulasi ini uji t Welch lebih baik dibandingkan uji t klasik karena memiliki kuasa* yang lebih besar.\")\r\n      } else {\r\n        paste0(\"Gambar 4.b: Persentase penolakan hipotesis nol dari uji t klasik \", slsh_persen, \"% lebih dari uji t Welch. Dengan demikian, dalam simulasi ini uji t klasik lebih baik dibandingkan uji t Welch karena memiliki kuasa* yang lebih besar.\")\r\n      }\r\n    }\r\n  })\r\n\r\n  ## Teks informasi tambahan perbandingan ----\r\n  output$teks_info_perbandingan <- renderText({\r\n    mu_1 <- input$mu_1\r\n    mu_2 <- input$mu_2\r\n    if (mu_1 == mu_2) {\r\n      \"*Galat tipe I merupakan kekeliruan karena menolak hipotesis nol yang sebenarnya hipotesis tersebut benar.\"\r\n    } else {\r\n      \"*Kuasa merupakan ketepatan dalam menolak hipotesis nol karena hipotesis tersebut sebenarnya memang salah.\"\r\n    }\r\n  })\r\n}\r\n\r\n# Membuat objek aplikasi Shiny ----\r\nshinyApp(ui = ui, server = server)\r\n","type":"text"}]
